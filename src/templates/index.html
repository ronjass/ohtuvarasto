{% extends "base.html" %}

{% block title %}Warehouse Manager - Home{% endblock %}

{% block content %}
<h1>Warehouse Manager</h1>

{% if warehouses %}
    {% for id, warehouse in warehouses.items() %}
    <div class="warehouse">
        <h3>{{ warehouse.name }}</h3>
        <div class="warehouse-info">
            <p>
                <strong>Balance:</strong> {{ warehouse.varasto.saldo }}
                / {{ warehouse.varasto.tilavuus }}
            </p>
            <p><strong>Free space:</strong>
                {{ warehouse.varasto.paljonko_mahtuu() }}
            </p>
        </div>
        {% set percentage =
            (warehouse.varasto.saldo / warehouse.varasto.tilavuus * 100)
            if warehouse.varasto.tilavuus > 0 else 0 %}
        <div class="progress-bar">
            <div class="progress-fill" style="width: {{ percentage }}%"></div>
        </div>
        {% if warehouse.stored_items %}
        <div class="items-list">
            <h4>ðŸ“¦ Items in storage:</h4>
            {% for item in warehouse.stored_items %}
            <span class="item">{{ item.name }} ({{ item.amount }})</span>
            {% endfor %}
        </div>
        {% endif %}
        <div class="actions">
            <form action="{{ url_for('add_content', warehouse_id=id) }}"
                  method="post">
                <input type="text" name="item_name" placeholder="Item name"
                       style="width: 100px;">
                <input type="number" name="amount" step="0.1" min="0.1"
                       placeholder="Amount" required style="width: 80px;">
                <button type="submit" class="btn-success">Add</button>
            </form>
            <form action="{{ url_for('remove_content', warehouse_id=id) }}"
                  method="post">
                <input type="number" name="amount" step="0.1" min="0.1"
                       placeholder="Amount" required style="width: 80px;">
                <button type="submit" class="btn-warning">Remove</button>
            </form>
            <a href="{{ url_for('edit_warehouse', warehouse_id=id) }}"
               class="btn btn-primary">Edit</a>
            <form action="{{ url_for('delete_warehouse', warehouse_id=id) }}"
                  method="post"
                  onsubmit="return confirm('Delete this warehouse?');">
                <button type="submit" class="btn-danger">Delete</button>
            </form>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="no-warehouses">
        <p>No warehouses yet.</p>
        <a href="{{ url_for('create_warehouse') }}"
           class="btn btn-success">Create your first warehouse</a>
    </div>
{% endif %}
{% endblock %}
